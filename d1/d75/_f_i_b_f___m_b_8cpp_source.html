<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ePhotosynthesis: /home/runner/work/ePhotosynthesis_C/ePhotosynthesis_C/src/MB/FIBF_MB.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ePhotosynthesis
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d75/_f_i_b_f___m_b_8cpp_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">FIBF_MB.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d1/d75/_f_i_b_f___m_b_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/**********************************************************************************************************************************************</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> *   Copyright   Xin-Guang Zhu, Yu Wang, Donald R. ORT and Stephen P. LONG</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * CAS-MPG Partner Institute for Computational Biology, Shanghai Institutes for Biological Sciences, CAS, Shanghai,200031</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * China Institute of Genomic Biology and Department of Plant Biology, Shanghai Institutes for Biological Sciences, CAS, Shanghai,200031</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * University of Illinois at Urbana Champaign</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> * Global Change and Photosynthesis Research Unit, USDA/ARS, 1406 Institute of Genomic Biology, Urbana, IL 61801, USA.</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> *</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> * Converted from Matlab to C++ by Douglas N. Friedel, National Center for Supercomputing Applications (2020)</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> *</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> *   This file is part of e-photosynthesis.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> *</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> *    e-photosynthesis is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> *    it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> *    the Free Software Foundation;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> *</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> *    e-photosynthesis is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> *    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"> *    GNU General Public License for more details.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"> *</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment"> *    You should have received a copy of the GNU General Public License (GPL)</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment"> *    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment"> *</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment"> **********************************************************************************************************************************************/</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/dae/_variables_8hpp.html">Variables.hpp</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dc7/_f_i_b_f_8hpp.html">modules/FIBF.hpp</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d5c/_f_i_8hpp.html">modules/FI.hpp</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="../../db/d0c/_b_f_8hpp.html">modules/BF.hpp</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="../../d9/d05/_xan_cycle_8hpp.html">modules/XanCycle.hpp</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment">// This function calculate the mass balance equation for the complete model of the light reactions.</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d0/d3a/namespacee_photosynthesis.html">ePhotosynthesis</a>;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../dc/ddc/namespacee_photosynthesis_1_1modules.html">ePhotosynthesis::modules</a>;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d2/d15/namespacee_photosynthesis_1_1conditions.html">ePhotosynthesis::conditions</a>;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><a class="code hl_class" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html">FIBFCondition</a>* FIBF::_MB_con(<span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code hl_class" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html">FIBFCondition</a>* <span class="keyword">const</span> FIBF_Con, <a class="code hl_class" href="../../da/d90/classe_photosynthesis_1_1_variables.html">Variables</a> *theVars) {</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="comment">// First Get the variables needed for the calcualtion step</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    BFCondition* BF_con = FIBF_Con-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">BF_con</a>;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    FICondition* FI_Con = FIBF_Con-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a2285536ae2b02dc1339e1601b6ec9bcc">FI_con</a>;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="comment">//       Calculate auxilary variable, PQ             //</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> PQ = theVars-&gt;FIBF_Pool.PQT - theVars-&gt;FI_Pool.QBt - BF_con-&gt;QH2 - BF_con-&gt;Qi -</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>                      BF_con-&gt;Qn - BF_con-&gt;Qr - BF_con-&gt;ISPoQH2 - BF_con-&gt;QHsemi;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    FIBF2FI_PQa = theVars-&gt;FI_Pool.QBt + BF_con-&gt;Qi + BF_con-&gt;Qn + BF_con-&gt;Qr + BF_con-&gt;ISPoQH2 +</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>                  BF_con-&gt;QHsemi;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    BF_con-&gt;Q = PQ;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    FIBF2FI_PQ = PQ;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    theVars-&gt;FI_RC.kA_d = FIBF_Con-&gt;kd;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    theVars-&gt;FI_RC.kU_d = FIBF_Con-&gt;kd;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    theVars-&gt;BF_RC.Kd = FIBF_Con-&gt;kd;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    BFCondition* BF_mb = BF::MB_con(t, BF_con, theVars);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    FICondition* FI_mb = FI::MB_con(t, FI_Con, theVars);</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="comment">// Assign the value of the calcualted BF_mb and FI_mb to FIBF_MB variable</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    FIBFCondition* dydt = <span class="keyword">new</span> FIBFCondition(BF_mb, FI_mb);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">// Now specially calcualte the mass balance equation for the rate constant of the heat dissipation</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="comment">//const double PHl = BF_con.PHl;           // Get the PH value of the lumen</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Hl = pow(10., BF_con-&gt;PHl);</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> QH = pow(10., 5.5) / (Hl + pow(10., 5.5));</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> RC = 0.1;                   <span class="comment">// RC is the relaxation constant, which is one term borrowed from Laisk et al., 1997;</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="comment">//   Here is the section implementing the nonphotochemical quenching.</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="comment">//PHl = theVars-&gt;BF2FIBFMB_PHl;</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keywordtype">double</span> dmax = 5. * pow(10., 8.) * QH;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="keywordflow">if</span> (theVars-&gt;XanCycle_BF_com) {</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        <span class="keywordflow">if</span> (XanCycle::getXanCycle2FIBF_Xstate() &gt; 0.3) {</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>            dmax = dmax * XanCycle::getXanCycle2FIBF_Xstate() / 0.3;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    }</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    dydt-&gt;kd = RC * (dmax - FIBF_Con-&gt;kd);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="comment">// Calculate the proton generation rate from the model of FI and use that to calculate the lumen PH //            //</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="comment">// one molecular water molecules to release four protons.</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Hroe = 4 * theVars-&gt;FI_Vel.vS3_S0 / theVars-&gt;AVR; <span class="comment">// 27 is the conversion of unit from micromole per meter squre leaf area to mmol per liter.</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Hvqo1 = theVars-&gt;BF_Vel.Vbf8 / theVars-&gt;AVR;      <span class="comment">// The rate of release of protons into lumen through Qo site</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Hvqo2 = theVars-&gt;BF_Vel.Vbf3 / theVars-&gt;AVR;      <span class="comment">// The rate of proton release into lumen through Qo site</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    dydt-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">BF_con</a>-&gt;BFHl = (Hvqo1 + Hvqo2 + Hroe - theVars-&gt;HPR * theVars-&gt;BF_Vel.Vbf11); <span class="comment">// BFHl The proton and protonated buffer species in lumen, similarly, we can only use the buff concentration, but, the proton concentration can not be used here.</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    dydt-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">BF_con</a>-&gt;PHl = - (Hvqo1 + Hvqo2 + Hroe - theVars-&gt;HPR * theVars-&gt;BF_Vel.Vbf11) / 1000. / 0.015;<span class="comment">//   PHl  The changes in PH of lumen, 0.03 is from Curz et al., 2001, Biochemistry.</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <span class="comment">//          Calculate the PH of stroma        //</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="comment">//const double v3 = theVars-&gt;FI_Vel.v3 ; // v3 The rate of exchange of QAQBH2 with PQ; There is two proton uptake from stroma</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <span class="comment">//const double v_r3 = theVars-&gt;FI_Vel.v_r3 ; // v_r3 The rate of exchange of QAQB with PQH2; there is two proton release into stroma</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="comment">//const double v3_n = theVars-&gt;FI_Vel.v3_n ; // v3_n The rate of exchange of QAnQBH2 with PQ; there is two protons uptake from stroma</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <span class="comment">//const double v_r3_n = theVars-&gt;FI_Vel.v_r3_n ; // v_r3_n The rate of exchange of QAnQB with PQH2; there is two protons release into stroma</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> GPQH2_qb = theVars-&gt;FI_Vel.v3 - theVars-&gt;FI_Vel.v_r3 + theVars-&gt;FI_Vel.v3_n -</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                            theVars-&gt;FI_Vel.v_r3_n;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> vqb = 2. * GPQH2_qb;<span class="comment">//   The total rate of proton uptake at the QB site of PSII.</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="comment">//const double Vqi = theVars-&gt;BF_Vel.Vqi ;   //   The rate of proton uptake from the stroma side</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Hvqi = theVars-&gt;BF_Vel.Vqi / theVars-&gt;AVR;  <span class="comment">// The rate of proton uptake from stroma at BF_con.Qi site of cytbc1 complex</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="comment">//const double vbfn2 = theVars-&gt;BF_Vel.vbfn2 ;   // The rate of proton consumption by formation of NADPH</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Hrqb = vqb / theVars-&gt;AVR; <span class="comment">// Convert the unit of vqb from micormole per meter square per second to mM s-1; vqb is the rate of QB2- reduction in thylakoid membrane.</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    dydt-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">BF_con</a>-&gt;BFHs = (theVars-&gt;HPR * theVars-&gt;BF_Vel.Vbf11 - Hrqb - Hvqi - theVars-&gt;BF_Vel.vbfn2);  <span class="comment">// BFHs The proton and protonated buffer species in stroma. The proton concentration is not used in the MB procedure. The reason is that the proton concentration is buffered and therefore did not changed linerly with the generation of the protons.</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    dydt-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">BF_con</a>-&gt;PHs = - (theVars-&gt;HPR * theVars-&gt;BF_Vel.Vbf11 - Hrqb - Hvqi - theVars-&gt;BF_Vel.vbfn2) /</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                        1000. / 0.015;  <span class="comment">// PHs, The changes of PH in stoma, 0.03 mol /PH from Laisk et al.</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> GPQH2_t = GPQH2_qb - theVars-&gt;BF_Vel.Vbf1 + theVars-&gt;BF_Vel.Vqi / 2.;  <span class="comment">// This is the total rate of PQH2 generation</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    dydt-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">BF_con</a>-&gt;Q = 0;        <span class="comment">// Q Quinone in thylakoid membrane in free form</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    dydt-&gt;<a class="code hl_variable" href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">BF_con</a>-&gt;QH2 = GPQH2_t; <span class="comment">// QH2 The PQH2 concentration; the coefficient 2 represent the fact that 2 protons were taken up by one Q2-.</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span><span class="preprocessor">#ifdef INCDEBUG</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <a class="code hl_define" href="../../d1/dc9/definitions_8hpp.html#a2799ea066c55ed8f9fc9ae8817674b28">DEBUG_DELTA</a>(dydt)</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="keywordflow">return</span> dydt;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>}</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span><a class="code hl_typedef" href="../../d0/d3a/namespacee_photosynthesis.html#adc3c94eec1aef7ff6933bec82ced5721">arr</a> FIBF::_MB(<span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> FIBFCondition* <span class="keyword">const</span> FIBF_Con, Variables *theVars) {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    FIBFCondition* dydt = _MB_con(t, FIBF_Con, theVars);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <a class="code hl_typedef" href="../../d0/d3a/namespacee_photosynthesis.html#adc3c94eec1aef7ff6933bec82ced5721">arr</a> tmp = dydt-&gt;toArray();</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keyword">delete</span> dydt;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>}</div>
<div class="ttc" id="a_b_f_8hpp_html"><div class="ttname"><a href="../../db/d0c/_b_f_8hpp.html">BF.hpp</a></div></div>
<div class="ttc" id="a_f_i_8hpp_html"><div class="ttname"><a href="../../d6/d5c/_f_i_8hpp.html">FI.hpp</a></div></div>
<div class="ttc" id="a_f_i_b_f_8hpp_html"><div class="ttname"><a href="../../d4/dc7/_f_i_b_f_8hpp.html">FIBF.hpp</a></div></div>
<div class="ttc" id="a_variables_8hpp_html"><div class="ttname"><a href="../../d1/dae/_variables_8hpp.html">Variables.hpp</a></div></div>
<div class="ttc" id="a_xan_cycle_8hpp_html"><div class="ttname"><a href="../../d9/d05/_xan_cycle_8hpp.html">XanCycle.hpp</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1_variables_html"><div class="ttname"><a href="../../da/d90/classe_photosynthesis_1_1_variables.html">ePhotosynthesis::Variables</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/dae/_variables_8hpp_source.html#l00086">Variables.hpp:86</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_f_i_b_f_condition_html"><div class="ttname"><a href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html">ePhotosynthesis::conditions::FIBFCondition</a></div><div class="ttdef"><b>Definition</b> <a href="../../d9/d16/_f_i_b_f_condition_8hpp_source.html#l00048">FIBFCondition.hpp:48</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_f_i_b_f_condition_html_a2285536ae2b02dc1339e1601b6ec9bcc"><div class="ttname"><a href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a2285536ae2b02dc1339e1601b6ec9bcc">ePhotosynthesis::conditions::FIBFCondition::FI_con</a></div><div class="ttdeci">FICondition * FI_con</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d16/_f_i_b_f_condition_8hpp_source.html#l00077">FIBFCondition.hpp:77</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_f_i_b_f_condition_html_a8a384e7b25eef5e9dbd282f12a6528e8"><div class="ttname"><a href="../../d6/dcd/classe_photosynthesis_1_1conditions_1_1_f_i_b_f_condition.html#a8a384e7b25eef5e9dbd282f12a6528e8">ePhotosynthesis::conditions::FIBFCondition::BF_con</a></div><div class="ttdeci">BFCondition * BF_con</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d16/_f_i_b_f_condition_8hpp_source.html#l00076">FIBFCondition.hpp:76</a></div></div>
<div class="ttc" id="adefinitions_8hpp_html_a2799ea066c55ed8f9fc9ae8817674b28"><div class="ttname"><a href="../../d1/dc9/definitions_8hpp.html#a2799ea066c55ed8f9fc9ae8817674b28">DEBUG_DELTA</a></div><div class="ttdeci">#define DEBUG_DELTA(x)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dc9/definitions_8hpp_source.html#l00168">definitions.hpp:168</a></div></div>
<div class="ttc" id="anamespacee_photosynthesis_1_1conditions_html"><div class="ttname"><a href="../../d2/d15/namespacee_photosynthesis_1_1conditions.html">ePhotosynthesis::conditions</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9b/_b_f_condition_8hpp_source.html#l00044">BFCondition.hpp:44</a></div></div>
<div class="ttc" id="anamespacee_photosynthesis_1_1modules_html"><div class="ttname"><a href="../../dc/ddc/namespacee_photosynthesis_1_1modules.html">ePhotosynthesis::modules</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d0c/_b_f_8hpp_source.html#l00037">BF.hpp:37</a></div></div>
<div class="ttc" id="anamespacee_photosynthesis_html"><div class="ttname"><a href="../../d0/d3a/namespacee_photosynthesis.html">ePhotosynthesis</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9b/_b_f_condition_8hpp_source.html#l00040">BFCondition.hpp:40</a></div></div>
<div class="ttc" id="anamespacee_photosynthesis_html_adc3c94eec1aef7ff6933bec82ced5721"><div class="ttname"><a href="../../d0/d3a/namespacee_photosynthesis.html#adc3c94eec1aef7ff6933bec82ced5721">ePhotosynthesis::arr</a></div><div class="ttdeci">std::vector&lt; double &gt; arr</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dc9/definitions_8hpp_source.html#l00083">definitions.hpp:83</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_b4ce64dcdf9db248a61cfe20020f05bd.html">MB</a></li><li class="navelem"><a class="el" href="../../d1/d75/_f_i_b_f___m_b_8cpp.html">FIBF_MB.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
