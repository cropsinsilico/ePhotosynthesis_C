<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ePhotosynthesis: /home/runner/work/ePhotosynthesis_C/ePhotosynthesis_C/src/rate/BF_Rate.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ePhotosynthesis
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d5/d01/_b_f___rate_8cpp_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">BF_Rate.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d5/d01/_b_f___rate_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/**********************************************************************************************************************************************</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> *   Copyright   Xin-Guang Zhu, Yu Wang, Donald R. ORT and Stephen P. LONG</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * CAS-MPG Partner Institute for Computational Biology, Shanghai Institutes for Biological Sciences, CAS, Shanghai,200031</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * China Institute of Genomic Biology and Department of Plant Biology, Shanghai Institutes for Biological Sciences, CAS, Shanghai,200031</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * University of Illinois at Urbana Champaign</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> * Global Change and Photosynthesis Research Unit, USDA/ARS, 1406 Institute of Genomic Biology, Urbana, IL 61801, USA.</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> *</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> * Converted from Matlab to C++ by Douglas N. Friedel, National Center for Supercomputing Applications (2020)</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> *</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> *   This file is part of e-photosynthesis.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> *</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> *    e-photosynthesis is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> *    it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> *    the Free Software Foundation;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> *</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> *    e-photosynthesis is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> *    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"> *    GNU General Public License for more details.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"> *</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment"> *    You should have received a copy of the GNU General Public License (GPL)</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment"> *    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment"> *</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment"> **********************************************************************************************************************************************/</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/dae/_variables_8hpp.html">Variables.hpp</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="../../db/d0c/_b_f_8hpp.html">modules/BF.hpp</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="../../d2/d00/tr_dyna_p_s_8hpp.html">modules/trDynaPS.hpp</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dc7/_f_i_b_f_8hpp.html">modules/FIBF.hpp</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d0/d3a/namespacee_photosynthesis.html">ePhotosynthesis</a>;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../dc/ddc/namespacee_photosynthesis_1_1modules.html">ePhotosynthesis::modules</a>;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d2/d15/namespacee_photosynthesis_1_1conditions.html">ePhotosynthesis::conditions</a>;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keywordtype">void</span> BF::_Rate(<span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code hl_class" href="../../dc/d30/classe_photosynthesis_1_1conditions_1_1_b_f_condition.html">BFCondition</a>* <span class="keyword">const</span> BF_con, <a class="code hl_class" href="../../da/d90/classe_photosynthesis_1_1_variables.html">Variables</a> *theVars) {</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    <span class="comment">// Step II get the concentration of differnet component //</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <span class="comment">//  This is the initialization step for the module of the BF_con.Q cycle, and ATP synthesis steps</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="keywordtype">double</span> ADP = BF_con-&gt;ADP; <span class="comment">// ADP in stroma</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="keywordtype">double</span> ATP = BF_con-&gt;ATP;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="keywordflow">if</span> (BF::PS_connect)</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        ATP = BF_con-&gt;<a class="code hl_variable" href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">parent</a>-&gt;<a class="code hl_variable" href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">parent</a>-&gt;<a class="code hl_variable" href="../../d3/d0b/classe_photosynthesis_1_1conditions_1_1_e_p_s_condition.html#a2678385edc2a28c4fc162686c7388501">CM_con</a>-&gt;<a class="code hl_variable" href="../../d4/dbe/classe_photosynthesis_1_1conditions_1_1_c_m_condition.html#af7a9d3593b6227918d3f322d05af5919">PS_PR_con</a>-&gt;<a class="code hl_variable" href="../../de/d3c/classe_photosynthesis_1_1conditions_1_1_p_s___p_r_condition.html#a68f4410ca13f2e3d2580df138af75ccd">PS_con</a>-&gt;ATP;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="keywordtype">double</span> Pi = BF::_Pi; <span class="comment">// Phosphate in stroma</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="keywordtype">double</span> Fdn = BF_con-&gt;Fdn;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <span class="keywordflow">if</span> (BF::RROEA_connect)</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        Fdn = BF_con-&gt;<a class="code hl_variable" href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">parent</a>-&gt;<a class="code hl_variable" href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">parent</a>-&gt;<a class="code hl_variable" href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">parent</a>-&gt;<a class="code hl_variable" href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">parent</a>-&gt;<a class="code hl_variable" href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">parent</a>-&gt;<a class="code hl_variable" href="../../d8/d64/classe_photosynthesis_1_1conditions_1_1tr_dyna_p_s_condition.html#aa4b91c573bca6a05f24f4a9998c3c381">RROEA_con</a>-&gt;Fd;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    <span class="comment">// Get the auxiliary variables //</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cytc1n = theVars-&gt;BF_Pool.kA_d - BF_con-&gt;cytc1; <span class="comment">// The concentration of reduced cytc1</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cytbLn = theVars-&gt;BF_Pool.kA_d - BF_con-&gt;cytbL; <span class="comment">// The concentration of reduced cytbL</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cytbHn = theVars-&gt;BF_Pool.kA_d - BF_con-&gt;cytbH; <span class="comment">// The concentration of reduced cytbH</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> cytc2n = theVars-&gt;BF_Pool.kA_f - BF_con-&gt;cytc2; <span class="comment">// The concentration of reduced cytc2</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Kl = theVars-&gt;BF_Pool.kA_U - BF_con-&gt;Ks;        <span class="comment">// The concentration of K in lumen</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Mgl = theVars-&gt;BF_Pool.kU_A - BF_con-&gt;Mgs;      <span class="comment">// The concentration of Mg in lumen</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Cll = theVars-&gt;BF_Pool.kU_d - BF_con-&gt;Cls;      <span class="comment">// The concentration of Cl in lumen</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Fd = theVars-&gt;BF_Pool.kU_f - Fdn;       <span class="comment">// The conncentration of oxidized Fd in stroma</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> A = theVars-&gt;BF_Pool.k1 - BF_con-&gt;An;           <span class="comment">// The concentration of oxidized electron acceptor in PSI</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> QST = theVars-&gt;BF_Pool.kA_d;                    <span class="comment">// Assuming that the total number of cytochrome is equal to the total number of quinone binding site;</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> QSe = QST - BF_con-&gt;Qi - BF_con-&gt;Qn - BF_con-&gt;Qr;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> P700p = theVars-&gt;BF_Pool.k23 - BF_con-&gt;P700;    <span class="comment">// The number of positive P700;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> NADP = theVars-&gt;BF_Pool.k30 - BF_con-&gt;NADPH;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keywordflow">if</span> (theVars-&gt;FIBF_PSPR_com) {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        ADP = theVars-&gt;ADP;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        <span class="keywordflow">if</span> (theVars-&gt;<a class="code hl_variable" href="../../da/d90/classe_photosynthesis_1_1_variables.html#acb14ea47288c8931bceec86581fcaebd">useC3</a>) {</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>            Pi = theVars-&gt;Pi;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>            Pi = theVars-&gt;PS2BF_Pi;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        }</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    }</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> CoeffVol = theVars-&gt;AVR;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Hfs = pow(10., -BF_con-&gt;PHs) * 1000.;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> OHs = pow(10., -14.) / (Hfs / 1000.) * 1000.;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> BFs = BF_con-&gt;BFHs - Hfs;          <span class="comment">// The concentration of the protonated buffer speices.</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>                                                   <span class="comment">// Notice here the variable BFHs represent the total concentration of both proton and the protonated buffer species in stroma</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> BFns = theVars-&gt;BF_Pool.kz - BFs; <span class="comment">// The total concentration of deprotonated buffer species in stroma;</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> RegPHs = 1.;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Temp1 = pow(10., 5.5 - 8.);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> a = Temp1 / (1. + Temp1);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Temp2 = pow(10., 5.5 - BF_con-&gt;PHl);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> b = Temp2 / (1. + Temp2);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> RegPHl = 1. - (b - a);</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Iin = theVars-&gt;BF_Param[0];</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="comment">// Calculate the rate of different reactions //</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Vmax = theVars-&gt;BF_RC.K1 * (BF_con-&gt;ISPo + BF_con-&gt;ISPHr);                     <span class="comment">// The maximum rate of formation of enzyme substrate complex</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    theVars-&gt;BF_Vel.Vbf1 = Vmax * BF_con-&gt;ISPo / (BF_con-&gt;ISPo + BF_con-&gt;ISPHr) * BF_con-&gt;QH2 /</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                           theVars-&gt;BF_Pool.k_r1; <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    theVars-&gt;BF_Vel.Vbf2 = theVars-&gt;BF_RC.K2 * BF_con-&gt;ISPoQH2 * RegPHl;                       <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    theVars-&gt;BF_Vel.Vbf3 = theVars-&gt;BF_RC.K3 * BF_con-&gt;QHsemi * BF_con-&gt;cytbL / theVars-&gt;BF_Pool.kA_d *</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                           RegPHl; <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    theVars-&gt;BF_Vel.Vbf4 = theVars-&gt;BF_RC.K4 * cytbLn * BF_con-&gt;cytbH / theVars-&gt;BF_Pool.kA_d; <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    theVars-&gt;BF_Vel.Vbf5 = theVars-&gt;BF_RC.K5 * cytbHn * BF_con-&gt;Qi / theVars-&gt;BF_Pool.kA_d;    <span class="comment">//;Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    theVars-&gt;BF_Vel.Vbf6 = theVars-&gt;BF_RC.K6 * cytbHn * BF_con-&gt;Qn / theVars-&gt;BF_Pool.kA_d;    <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    theVars-&gt;BF_Vel.Vbf7 = theVars-&gt;BF_RC.K7 * theVars-&gt;BF_Pool.kA_d * QSe / QST * BF_con-&gt;Q /</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                           theVars-&gt;BF_Pool.k_r1; <span class="comment">// QSe ans QST represent the empty quinone binding site and the total number of quinone binding site respectively. Unit: micromole s-1 per meter squareleaf area;</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    theVars-&gt;BF_Vel.Vbf8 = theVars-&gt;BF_RC.K8 * theVars-&gt;BF_Pool.kA_d *</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                           (BF_con-&gt;ISPHr / theVars-&gt;BF_Pool.kA_d * BF_con-&gt;cytc1 /</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                            theVars-&gt;BF_Pool.kA_d - BF_con-&gt;ISPo / theVars-&gt;BF_Pool.kA_d * cytc1n /</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                            theVars-&gt;BF_Pool.kA_d / theVars-&gt;BF_RC.KE8) * RegPHl; <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    theVars-&gt;BF_Vel.Vbf9 = theVars-&gt;BF_RC.K9 * theVars-&gt;BF_Pool.kA_d *</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                           (cytc1n / theVars-&gt;BF_Pool.kA_d * BF_con-&gt;cytc2 / theVars-&gt;BF_Pool.kA_d -</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                            BF_con-&gt;cytc1 / theVars-&gt;BF_Pool.kA_d * cytc2n / theVars-&gt;BF_Pool.kA_d /</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                            theVars-&gt;BF_RC.KE9); <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> KE10 = 10.;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    theVars-&gt;BF_Vel.Vbf10 = theVars-&gt;BF_RC.K10 * P700p * cytc2n / theVars-&gt;BF_Pool.k23 -</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                            theVars-&gt;BF_RC.K10 * BF_con-&gt;cytc2 * BF_con-&gt;P700 / theVars-&gt;BF_Pool.k23 /</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                            KE10; <span class="comment">// Unit: micromole s-1 m-2 leaf area</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <span class="keywordtype">double</span> Ytemp;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="keywordflow">if</span> (Hfs &lt; 0.) {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>        Ytemp = 0.;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        Ytemp = 25.359 - 0.0425 * pow(BF_con-&gt;PHs, 3.) + 1.0986 * pow(BF_con-&gt;PHs, 2.) - 9.1831 * BF_con-&gt;PHs;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    }</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="comment">// Calculation of the different excition transfer reactions occurred in PSI</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    theVars-&gt;BF_Vel.Vipc = BF_con-&gt;Aip * theVars-&gt;BF_RC.Kau; <span class="comment">// The rate of exciton transfer from peripheral antenna to core antenna; unit: micromole m-2 s-1 Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    theVars-&gt;BF_Vel.Vicp = BF_con-&gt;U * theVars-&gt;BF_RC.Kua;   <span class="comment">// The rate of exciton transfer from core antenna to peripheral antenna Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <span class="comment">// Iin is the total absorbed light</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    theVars-&gt;BF_Vel.Vinc = Iin * FIBF::getChlPSI() / (FIBF::getChlT2() + FIBF::getChlPSI()) * 95. / 200.;  <span class="comment">// PPFD absorbed by core antenna of PSI    Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    theVars-&gt;BF_Vel.Vinp = Iin * FIBF::getChlPSI() / (FIBF::getChlT2() + FIBF::getChlPSI()) * 105. / 200.; <span class="comment">// PPFD absorbed by peripheral antenna of PSI  Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    theVars-&gt;BF_Vel.Vdp = BF_con-&gt;Aip * theVars-&gt;BF_RC.Kd; <span class="comment">// The rate of heat dissipation from peripheral antenna Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    theVars-&gt;BF_Vel.Vdc = BF_con-&gt;U * theVars-&gt;BF_RC.Kd;   <span class="comment">// The rate heat dissipation from core antenna Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    theVars-&gt;BF_Vel.Vfp = BF_con-&gt;Aip * theVars-&gt;BF_RC.Kf; <span class="comment">// The fluorescence emission from peripheral antenna Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    theVars-&gt;BF_Vel.Vfc = BF_con-&gt;U * theVars-&gt;BF_RC.Kf;   <span class="comment">// The fluorescence emission from core antenna Unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="comment">// The other empirical rates calculations</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    theVars-&gt;BF_Vel.Vsfd = 0.; <span class="comment">// The sink for Fd utilization; unit: mmol l-1 s-1;</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> CO2 = theVars-&gt;CO2_cond * 3. * pow(10., 4.);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> MaxCO2Rate = 100. * CO2 / (CO2 + 460.);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    theVars-&gt;BF_Vel.VsATP = MaxCO2Rate * 1.5 / CoeffVol * ATP / 1.5;        <span class="comment">//(ADP + ATP); // The sink for ATP utilizaiton, 20 represent the of CO2 assimilation, since 1 meter square amount to 27 ml, therefore, the sink capacity should be 20 * 1.5 * 1.5 mmol / 27 l-1 s-1. The 1.5 represents the 1.5 ATP consumption per CO2 fixation.  Unit: mmol l-2 s-1</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    theVars-&gt;BF_Vel.VsNADPH = MaxCO2Rate / CoeffVol * 1 * BF_con-&gt;NADPH / theVars-&gt;BF_Pool.k30; <span class="comment">// For 6 C6 = 5 C6 + 1C6;</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    theVars-&gt;BF_Vel.VgPQH2 = BF_con-&gt;Q * 800. * RegPHs;                              <span class="comment">// Assuming that the rate of generation of PQH2 through QB site only depend on the PQ and PQH2 exchange capacity.</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keywordtype">double</span> NetCharge = Hfs + BF_con-&gt;Ks + 2. * BF_con-&gt;Mgs - OHs - BF_con-&gt;Cls - BFns; <span class="comment">// The difference between the positive and negative charge in stroma. It was assumed that the charge is in equilibrium state in the beginning of the model, therefore, the difference in the positive and negative charges reflect the charges forming electrical potential cross the membrane. The unit is mmol l-1.</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    NetCharge = NetCharge / 1000.;                                                  <span class="comment">// The unit conversion. Convert from mmol l-1 to mol l-1.</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    NetCharge = NetCharge * theVars-&gt;BF_RC.RVA;                                    <span class="comment">// Convert from mol l-1 to mol cm-2.</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> AfC = 6.022 * pow(10., 23.);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> UnitCharge = 1.6 * pow(10., -19.);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    NetCharge = NetCharge * AfC * UnitCharge;                                      <span class="comment">// Unit: Coulomb cm-2</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> MPotential = 2. * NetCharge / 6. * pow(10., 6.);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> temp = - MPotential / 0.026;                                      <span class="comment">// 0.026 pools together the RT/F; With R as 8.314 J K-1 mol-1; T: 298; F: 9.648*10^4 C mol-1.</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="keywordtype">double</span> JMg;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keywordtype">double</span> JCl;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keywordtype">double</span> JK;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <span class="keywordflow">if</span> (temp == 0.) {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>        JK = theVars-&gt;BF_RC.PK * (Kl - BF_con-&gt;Ks) / 10.;     <span class="comment">// The flux of K from lumen to stroma; unit: mol/dm2/s; the unit of permeability is: cm s-1; 10 represent the conversion from cm s-1 to dm s-1; Remember that 1 liter is 1 dm3.</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        JCl = theVars-&gt;BF_RC.PCl * (Cll - BF_con-&gt;Cls) / 10.; <span class="comment">// The flux of Cl from lumen to stroma; unit: mol/dm2/s; unit of permeability is cm s-1; 10 represent the conversion from cm s-1 to dm s-1; remember that 1 liter amount to 1 decimeter cube</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        JMg = theVars-&gt;BF_RC.PMg * (Mgl - BF_con-&gt;Mgs) / 10.; <span class="comment">// The flux of Mg from lumen to stroma; unit: mol/dm2/s; unit of permeability is cm s-1; 10 represent the conversion of cm s-1 to dm s-1. Remember that 1 liter amount to 1 decimeter cube.</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        JK = theVars-&gt;BF_RC.PK * temp * (Kl - BF_con-&gt;Ks * exp(-temp)) / (1. - exp(-temp)) / 10.;                 <span class="comment">// The flux of K from lumen to stroma; unit: mol/dm2/s; the unit of permeability is: cm s-1; 10 represent the conversion from cm s-1 to dm s-1; Remember that 1 liter is 1 dm3.</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>        JCl = - theVars-&gt;BF_RC.PCl * temp * (Cll - BF_con-&gt;Cls * exp(temp)) / (1. - exp(temp)) / 10.;             <span class="comment">// The flux of Cl from lumen to stroma; unit: mol/dm2/s; unit of permeability is cm s-1; 10 represent the conversion from cm s-1 to dm s-1; remember that 1 liter amount to 1 decimeter cube</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>        JMg = theVars-&gt;BF_RC.PMg * temp / 2. * (Mgl - BF_con-&gt;Mgs * exp(-temp / 2.)) /</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>              (1. - exp(-temp / 2.)) / 10.; <span class="comment">// The flux of Mg from lumen to stroma; unit: mol/dm2/s; unit of permeability is cm s-1; 10 represent the conversion of cm s-1 to dm s-1. Remember that 1 liter amount to 1 decimeter cube.</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    }</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    theVars-&gt;BF_Vel.Vqi  = theVars-&gt;BF_RC.Kqi * BF_con-&gt;Qr * 2. / 0.72 * Ytemp; <span class="comment">// The rate of proton uptake at BF_con.Qi site of bc1 complex; Unit: micromole s-1 m-2 leaf area; the coefficient 2 represents that two protons were taken up at the same time.0.72 represents the calculated proton uptake rate at BF_con.Qi site when PH is 9.</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    theVars-&gt;BF_Vel.JKc  = JK / theVars-&gt;BF_RC.RVA / 100.;                     <span class="comment">// 100 represent the conversion to cm-2;  theVars-&gt;BF_RC.RVA is the ratio between the lumen volume and thylakoid membrane area.</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    theVars-&gt;BF_Vel.JMgc  = JMg / theVars-&gt;BF_RC.RVA / 100.;                   <span class="comment">// 100 represent the conversion to cm-2;  theVars-&gt;BF_RC.RVA is the ratio between the lumen volume and thylakoid membrane area.</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    theVars-&gt;BF_Vel.JClc  = JCl / theVars-&gt;BF_RC.RVA / 100.;                   <span class="comment">// 100 represent the conversion to cm-2;  theVars-&gt;BF_RC.RVA is the ratio between the lumen volume and thylakoid membrane area.</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> P700e = BF_con-&gt;U * (theVars-&gt;BF_Pool.k23 - P700p) / 120.;                <span class="comment">// The amount of excited P700; micromole m-2 leaf area</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    theVars-&gt;BF_Vel.Vbf15 = P700e * theVars-&gt;BF_RC.K15 * A / theVars-&gt;BF_Pool.k1;        <span class="comment">// The rate of PSI primary charge separation; unit: micromole m-2 leaf area per second</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    theVars-&gt;BF_Vel.Vbf16 = BF_con-&gt;An * theVars-&gt;BF_RC.K16 * Fd / theVars-&gt;BF_Pool.kU_f; <span class="comment">// The rate of electron transport from the electron acceptor of PSI to Fd; Unit: micromole m-2 leaf area s-1;</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> DiffPH = BF_con-&gt;PHs - BF_con-&gt;PHl;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> DeltaG11 = BF::DeltaGo - 2.3 * BF::RT * theVars-&gt;HPR * DiffPH + theVars-&gt;HPR * MPotential *</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                            9.6 * pow(10., 4.);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> KE11 = exp(-DeltaG11 / (BF::RT)); <span class="comment">// The equilibrium constant of ATP synthesis</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Temp = theVars-&gt;BF_RC.Vmax11 * (ADP * Pi - ATP / KE11) /</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                        ((theVars-&gt;BF_RC.KM1ADP * theVars-&gt;BF_RC.KM1PI) *</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>                         (1. + ADP / theVars-&gt;BF_RC.KM1ADP + Pi / theVars-&gt;BF_RC.KM1PI + ADP * Pi /</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>                          (theVars-&gt;BF_RC.KM1ADP * theVars-&gt;BF_RC.KM1PI))); <span class="comment">// Unit: mmol l- s-1; The stroma volume is used as a basis for the volume</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="keywordtype">double</span> Vbf11 = Temp;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="keywordflow">if</span> (Vbf11 &lt; 0.)</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        Vbf11 = 0.;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="comment">// The EPS_ATP_Rate is used in the overall model for the calculation of the mass balance equation of ATP.</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    BF::EPS_ATP_Rate = Vbf11;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    theVars-&gt;BF_Vel.vbfn2 = 2. * theVars-&gt;BF_RC.V2M *</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>                            (Fdn * NADP / theVars-&gt;BF_Pool.kU_f - Fd * BF_con-&gt;NADPH /</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                             (theVars-&gt;BF_Pool.kU_f * theVars-&gt;BF_RC.KE2)) /</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                            (theVars-&gt;BF_RC.KM2NADP * (1. + NADP / theVars-&gt;BF_RC.KM2NADP +</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                                                       BF_con-&gt;NADPH / theVars-&gt;BF_RC.KM2NADPH)); <span class="comment">// mmol/l/s  //QF add 2*</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    theVars-&gt;BF_Vel.vcet = theVars-&gt;BF_RC.V2M * BF_con-&gt;Qi * Fdn / theVars-&gt;BF_Pool.kU_f * CoeffVol;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="comment">//   Transfer infroamtion between models                     //</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    theVars-&gt;BF_Vel.Vbf11  = Vbf11;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span><span class="preprocessor">#ifdef INCDEBUG</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <a class="code hl_define" href="../../d1/dc9/definitions_8hpp.html#a2bfd2762aabf6445ede06c60f5e9b228">DEBUG_INTERNAL</a>(theVars-&gt;BF_Vel)</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="keywordflow">if</span> (theVars-&gt;<a class="code hl_variable" href="../../da/d90/classe_photosynthesis_1_1_variables.html#ae3d78c97a07b1dc1b55927467cd484aa">record</a>) {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        <span class="comment">//   Part V Output of Velocity for plot //</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="keywordflow">if</span> (t &gt; BF::TIME) {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>            BF::N++;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            BF::TIME = t;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        theVars-&gt;BF_VEL.insert(BF::N - 1, t, theVars-&gt;BF_Vel);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        theVars-&gt;BF2OUT.Fdn = Fdn;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        theVars-&gt;BF2OUT.PHs = BF_con-&gt;PHs;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        theVars-&gt;BF2OUT.PHl = BF_con-&gt;PHl;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        theVars-&gt;BF2OUT.NADPH = BF_con-&gt;NADPH;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        theVars-&gt;BF2OUT.ATP = ATP;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    }</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>}</div>
<div class="ttc" id="a_b_f_8hpp_html"><div class="ttname"><a href="../../db/d0c/_b_f_8hpp.html">BF.hpp</a></div></div>
<div class="ttc" id="a_f_i_b_f_8hpp_html"><div class="ttname"><a href="../../d4/dc7/_f_i_b_f_8hpp.html">FIBF.hpp</a></div></div>
<div class="ttc" id="a_variables_8hpp_html"><div class="ttname"><a href="../../d1/dae/_variables_8hpp.html">Variables.hpp</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1_variables_html"><div class="ttname"><a href="../../da/d90/classe_photosynthesis_1_1_variables.html">ePhotosynthesis::Variables</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/dae/_variables_8hpp_source.html#l00086">Variables.hpp:86</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1_variables_html_acb14ea47288c8931bceec86581fcaebd"><div class="ttname"><a href="../../da/d90/classe_photosynthesis_1_1_variables.html#acb14ea47288c8931bceec86581fcaebd">ePhotosynthesis::Variables::useC3</a></div><div class="ttdeci">bool useC3</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dae/_variables_8hpp_source.html#l00853">Variables.hpp:853</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1_variables_html_ae3d78c97a07b1dc1b55927467cd484aa"><div class="ttname"><a href="../../da/d90/classe_photosynthesis_1_1_variables.html#ae3d78c97a07b1dc1b55927467cd484aa">ePhotosynthesis::Variables::record</a></div><div class="ttdeci">bool record</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dae/_variables_8hpp_source.html#l00813">Variables.hpp:813</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_b_f_condition_html"><div class="ttname"><a href="../../dc/d30/classe_photosynthesis_1_1conditions_1_1_b_f_condition.html">ePhotosynthesis::conditions::BFCondition</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9b/_b_f_condition_8hpp_source.html#l00049">BFCondition.hpp:49</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_c_m_condition_html_af7a9d3593b6227918d3f322d05af5919"><div class="ttname"><a href="../../d4/dbe/classe_photosynthesis_1_1conditions_1_1_c_m_condition.html#af7a9d3593b6227918d3f322d05af5919">ePhotosynthesis::conditions::CMCondition::PS_PR_con</a></div><div class="ttdeci">PS_PRCondition * PS_PR_con</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d38/_c_m_condition_8hpp_source.html#l00080">CMCondition.hpp:80</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_condition_base_html_a9c035cae5458d01a81f8a4eb4a162dc6"><div class="ttname"><a href="../../d4/d2c/classe_photosynthesis_1_1conditions_1_1_condition_base.html#a9c035cae5458d01a81f8a4eb4a162dc6">ePhotosynthesis::conditions::ConditionBase::parent</a></div><div class="ttdeci">U * parent</div><div class="ttdoc">The parent Condition instance.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df2/_condition_base_8hpp_source.html#l00089">ConditionBase.hpp:89</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_e_p_s_condition_html_a2678385edc2a28c4fc162686c7388501"><div class="ttname"><a href="../../d3/d0b/classe_photosynthesis_1_1conditions_1_1_e_p_s_condition.html#a2678385edc2a28c4fc162686c7388501">ePhotosynthesis::conditions::EPSCondition::CM_con</a></div><div class="ttdeci">CMCondition * CM_con</div><div class="ttdef"><b>Definition</b> <a href="../../d1/da5/_e_p_s_condition_8hpp_source.html#l00079">EPSCondition.hpp:79</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1_p_s___p_r_condition_html_a68f4410ca13f2e3d2580df138af75ccd"><div class="ttname"><a href="../../de/d3c/classe_photosynthesis_1_1conditions_1_1_p_s___p_r_condition.html#a68f4410ca13f2e3d2580df138af75ccd">ePhotosynthesis::conditions::PS_PRCondition::PS_con</a></div><div class="ttdeci">PSCondition * PS_con</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d3c/_p_s___p_r_condition_8hpp_source.html#l00074">PS_PRCondition.hpp:74</a></div></div>
<div class="ttc" id="aclasse_photosynthesis_1_1conditions_1_1tr_dyna_p_s_condition_html_aa4b91c573bca6a05f24f4a9998c3c381"><div class="ttname"><a href="../../d8/d64/classe_photosynthesis_1_1conditions_1_1tr_dyna_p_s_condition.html#aa4b91c573bca6a05f24f4a9998c3c381">ePhotosynthesis::conditions::trDynaPSCondition::RROEA_con</a></div><div class="ttdeci">RROEACondition * RROEA_con</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d92/tr_dyna_p_s_condition_8hpp_source.html#l00079">trDynaPSCondition.hpp:79</a></div></div>
<div class="ttc" id="adefinitions_8hpp_html_a2bfd2762aabf6445ede06c60f5e9b228"><div class="ttname"><a href="../../d1/dc9/definitions_8hpp.html#a2bfd2762aabf6445ede06c60f5e9b228">DEBUG_INTERNAL</a></div><div class="ttdeci">#define DEBUG_INTERNAL(x)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dc9/definitions_8hpp_source.html#l00167">definitions.hpp:167</a></div></div>
<div class="ttc" id="anamespacee_photosynthesis_1_1conditions_html"><div class="ttname"><a href="../../d2/d15/namespacee_photosynthesis_1_1conditions.html">ePhotosynthesis::conditions</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9b/_b_f_condition_8hpp_source.html#l00044">BFCondition.hpp:44</a></div></div>
<div class="ttc" id="anamespacee_photosynthesis_1_1modules_html"><div class="ttname"><a href="../../dc/ddc/namespacee_photosynthesis_1_1modules.html">ePhotosynthesis::modules</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d0c/_b_f_8hpp_source.html#l00037">BF.hpp:37</a></div></div>
<div class="ttc" id="anamespacee_photosynthesis_html"><div class="ttname"><a href="../../d0/d3a/namespacee_photosynthesis.html">ePhotosynthesis</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9b/_b_f_condition_8hpp_source.html#l00040">BFCondition.hpp:40</a></div></div>
<div class="ttc" id="atr_dyna_p_s_8hpp_html"><div class="ttname"><a href="../../d2/d00/tr_dyna_p_s_8hpp.html">trDynaPS.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_1fbafb2e497071715f57e2efc3e962c0.html">rate</a></li><li class="navelem"><a class="el" href="../../d5/d01/_b_f___rate_8cpp.html">BF_Rate.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
